let properties=[{id:1,name:"Beach Hotel",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"Hotel",minPeople:1,maxPeople:2,minStay:1,maxStay:5,pricePerNight:"$157",bedrooms:1,bathrooms:1,image:"images/beach-house.webp",description:"Welcome to ",mealOptions:[{description:"Meal option selections available upon booking.",type:"None",price:0},{type:"Breakfast",price:30},{type:"Lunch",price:50},{type:"Dinner",price:70}]},{id:2,name:"Mary's Hostel Owaisis",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"Hostel",minPeople:1,maxPeople:1,minStay:1,maxStay:10,pricePerNight:"$30",bedrooms:1,bathrooms:1,image:"images/marys-hostel.webp",description:"Welcome to ",mealOptions:[{type:"None",price:0},{type:"Breakfast",price:30},{type:"Lunch",price:50},{type:"Dinner",price:70}]},{id:3,name:"Zangers Loft",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"Motel",minPeople:2,maxPeople:4,minStay:3,maxStay:10,pricePerNight:"$90",bedrooms:3,bathrooms:2,image:"images/zangers-loft.webp",description:"Welcome to ",mealOptions:[{type:"None",price:0},{type:"Breakfast",price:30},{type:"Lunch",price:50},{type:"Dinner",price:70}]},{id:4,name:"Ambers Retreat",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"House",minPeople:1,maxPeople:4,minStay:2,maxStay:15,pricePerNight:"$240",bedrooms:4,bathrooms:3,image:"images/ambers-retreat.webp",description:"Welcome to ",mealOptions:[{type:"None",description:"Kitchen available for use"}]},{id:5,name:"Beach Hotel",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"Hotel",minPeople:1,maxPeople:2,minStay:1,maxStay:5,pricePerNight:"$157",bedrooms:1,bathrooms:1,image:"images/beach-house.webp",description:"Welcome to ",mealOptions:[{type:"None",price:0},{type:"Breakfast",price:30},{type:"Lunch",price:50},{type:"Dinner",price:70}]},{id:6,name:"Mary's Hostel Owaisis",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"Hostel",minPeople:1,maxPeople:1,minStay:1,maxStay:10,pricePerNight:"$30",bedrooms:1,bathrooms:1,image:"images/marys-hostel.webp",description:"Welcome to ",mealOptions:[{type:"None",price:0},{type:"Breakfast",price:30},{type:"Lunch",price:50},{type:"Dinner",price:70}]},{id:7,name:"Zangers Loft",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"Motel",minPeople:2,maxPeople:4,minStay:3,maxStay:10,pricePerNight:"$90",bedrooms:3,bathrooms:2,image:"images/zangers-loft.webp",description:"Welcome to ",mealOptions:[{type:"None",price:0},{type:"Breakfast",price:30},{type:"Lunch",price:50},{type:"Dinner",price:70}]},{id:8,name:"Ambers Retreat",location:"Taupō",longitude:178.0176,latitude:-38.6623,accommodationType:"House",minPeople:1,maxPeople:4,minStay:2,maxStay:15,pricePerNight:"$240",bedrooms:4,bathrooms:3,image:"images/ambers-retreat.webp",description:"Welcome to ",mealOptions:[{type:"None",description:"Kitchen available for use"}]}];$(document).ready(function(){new fullpage("#fullpage",{licenseKey:"gplv3-license",controlArrows:!1}),mapboxgl.accessToken="pk.eyJ1IjoiY2lhcmFuc2xvdyIsImEiOiJjbHY0ZW91YnYwOGV3MmlwOGQ5b3l3a3J3In0.EFWZEAWA13ehFAw5jdLqJA",fullpage_api.setAllowScrolling(!1);let n=new Swiper(".swiper",{direction:"horizontal",pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});$("#goToHome").click(function(){fullpage_api.moveTo(1,0)}),$("#goToSearch").click(function(){fullpage_api.moveTo(1,1)}),$("#goToAccommodations").click(function(){fullpage_api.silentMoveTo(1,2)});{var e=Array.from(new Set(properties.map(e=>e.accommodationType)));e.sort();let a=$("#type");a.empty(),a.append('<option value="any">Any</option>'),e.forEach(e=>{a.append(`<option value="${e}">${e}</option>`)})}function c(){var e=$("#startDate").datepicker("getDate"),a=$("#endDate").datepicker("getDate");return e&&a?(a=Math.abs(a.getTime()-e.getTime()),Math.ceil(a/864e5)):0}function a(t){var i=window.matchMedia("(max-width: 600px)").matches?1:window.matchMedia("(max-width: 1024px)").matches?2:3,e=$(".swiper-wrapper");e.empty();for(let a=0;a<t.length;a+=i){var o=$('<div class="swiper-slide"></div>');for(let e=a;e<a+i&&e<t.length;e++){var p=t[e],p=`
                <div class="property">
                    <img src="${p.image}" alt="${p.name}">
                    <div class="property-details">
                        <h3>${p.name}</h3>
                        <p>${p.accommodationType}</p>
                        <h4>${p.pricePerNight}</h4>
                        <p>Min Stay: ${p.minStay} nights</p>
                        <p>Max Stay: ${p.maxStay} nights</p>
                        <div class="property-amenities">
                            <p>${p.bedrooms} <i class="fa-solid fa-bed"></i></p>
                            <p>${p.bathrooms} <i class="fa-solid fa-bath"></i></p>
                        </div>
                        <button class="read-more" data-id="${p.id}">Read More</button>
                    </div>
                </div>
            `;o.append(p)}e.append(o)}n.destroy(!0,!0),n=new Swiper(".swiper",{direction:"horizontal",pagination:{el:".swiper-pagination"}}),fullpage_api.reBuild(),$(".read-more").click(function(){var p=$(this).data("id");{let e=$("#selectedCardModal"),a=properties[0].mealOptions[0].description,t=`
      <div class="selected-modal">
        <button class="close-modal"><i class="fa-solid fa-xmark"></i></button> <!-- Close button added here -->
        <img src="${properties[p-1].image}">

        <div class="modal-contents">
          <div class="content-container">

            <div class="column1">
              <h3>${properties[p-1].name}</h3>
              <p>${properties[p-1].description}</p>
              <h4>Meal Options</h4>
              <p>${a}</p>

              <div class="property-amenities">
                <p>${properties[p-1].bedrooms} <i class="fa-solid fa-bed"></i></p>
                <p>${properties[p-1].bathrooms} <i class="fa-solid fa-bath"></i></p>
              </div>
            </div>

            <div class="column2">
              <div class="map" id="map"></div>

              <div class="price-and-button">
                <h3>${properties[p-1].pricePerNight}</h3>
                <button class="book-now" data-id="${p}">Book Now</button>
              </div>
            </div>

          </div>
        </div>
      </div>
    `,i=properties[p-1].longitude,o=properties[p-1].latitude;e.empty(),e.append(t);{var r=i;var l=o;let e=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[r,l],zoom:13});e.on("load",function(){e.resize()}),(new mapboxgl.Marker).setLngLat([r,l]).addTo(e)}n.destroy(!0,!0),n=new Swiper(".swiper",{direction:"horizontal",pagination:{el:".swiper-pagination"}}),fullpage_api.reBuild(),$(".close-modal").click(function(){fullpage_api.moveTo(1,2)}),$(".book-now").click(function(){var s=$(this).data("id");{s=properties[s-1];let e=$("#total"),a=s.name,t=parseInt(s.pricePerNight.replace("$",""),10),i=c(),o=0<s.mealOptions.length?s.mealOptions[0].price:0,p=t*i,r=o*i,l=p+r,n="";s.mealOptions.forEach((e,a)=>{a=0===a?"selected-meal":"";n+=`<button class="meal-option ${a}" data-type="${e.type}" data-price="${e.price}">${e.type}</button>`}),s=`
      <div class="total-container">
        <div class="name-and-price">
          <h3>${a}</h3>
          <h3>${s.pricePerNight}</h3>
        </div>
        <ul>
          <li>${$("#guests").val()} Guest</li>
          <li>${i} Nights stay + selected meal</li>
        </ul>
  
        <div class="name-and-price">
          <h3>Meal Options</h3>
          <h3 id="mealPriceDisplay">$${o}</h3>
        </div>
  
        <div class="meal-options">
          ${n}
        </div>
  
        <h4>Total Price</h4>
        <p id="importantMessage">*Note that the total price is multiplied by Accommodation + Meal x Nights staying</p>
        <div class="total-price">
          <h3>Total</h3>
          <h3 id="totalPriceDisplay">$${l}</h3>
        </div>
        <button id="complete">Complete Booking</button>
      </div>
    `,e.empty(),e.append(s),$(".meal-option").click(function(){var e=parseInt($(this).data("price"),10),a=e*i,a=p+a;$("#mealPriceDisplay").text("$"+e),$("#totalPriceDisplay").text("$"+a),$(".meal-option").removeClass("selected-meal"),$(this).addClass("selected-meal")})}fullpage_api.moveTo(1,4)})}fullpage_api.moveTo(1,3)})}$("#startDate").datepicker({dateFormat:"dd/mm/yy"}),$("#endDate").datepicker({dateFormat:"dd/mm/yy"}),$("#searchButton").click(function(e){if(e.preventDefault(),function(){let e=!0,a="";return"#"===$("#guests").val()&&(e=!1,a+="Please select number of guests.<br>"),""===$("#startDate").val()&&(e=!1,a+="Please select a start date.<br>"),""===$("#endDate").val()&&(e=!1,a+="Please select an end date.<br>"),e?$("#error-message").hide():$("#error-message").html(a).show(),e}()){fullpage_api.moveTo(1,2);{let t=$("#type").val(),i=parseInt($("#guests").val(),10)||0,o=parseInt($("#bedrooms").val(),10)||0,p=parseInt($("#bathrooms").val(),10)||0,r=parseInt($("#minPrice").val().replace("$",""),10)||0,l=parseInt($("#maxPrice").val().replace("$",""),10)||1/0,n=c(),e=properties.filter(e=>{var a=parseInt(e.pricePerNight.replace("$",""),10);return("any"===t||e.accommodationType===t)&&e.minPeople<=i&&e.maxPeople>=i&&e.bedrooms>=o&&e.bathrooms>=p&&a>=r&&a<=l&&e.minStay<=n&&e.maxStay>=n});a(e)}}else console.log("Filters not valid")}),a(properties)});